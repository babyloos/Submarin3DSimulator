<html>
<head>
    <meta charset="utf-8">
    <title>Submarine Simulator</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/index.css">
      <!--meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; media-src *; img-src 'self' data: content:;">-->
    <meta name="viewport"
        content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no, viewport-fit=cover">
    <!-- iOS/Safari用 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- Android/Chrome用 -->
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body>
    <!-- トップ画面 -->
    <div id="topPage" class="activePage">
        <div class="video_wrapper">
        <video src="./resources/movie/title_back_test.mp4" playsinline autoplay muted loop width="100%"></video>
            <!-- タイトル画面 -->
            <div id="titlePage" class="absolutePage vignette activePage">
                <div class="menu text-center">
                    <div>
                        <div class="titleBackground">
                            <h1 glot-model='RES_Title'>潜水艦3Dシミュレータ</h1>
                        </div>
                        <div class="menuButtonWrapper">
                            <div class="row">
                                <button id="newGameButton" class="btn btn-info" glot-model='RES_NewGame'>ニューゲーム</button>
                            </div>
                            <div class="row">
                                <button id="continueButton" class="btn btn-info" glot-model='RES_Continue'>コンティニュー</button>
                            </div>
                            <div class="row">
                                <button id="manualButton" class="btn btn-info" glot-model='RES_Manual'>マニュアル</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- マニュアル画面 -->
            <div id="manualPage" class="vignette hiddenPage">
                <div id="manualTitle" class="ms-10">
                    <h1 class="" glot-model='RES_Manual'>マニュアル</h1>
                </div>
                <div id="manualMessageBox" class="overflow-auto">
                  <h5 glot-model='RES_Purpose'>ゲームの目的</h5>
                  <p glot-model='RES_ManualOverview'>第二次大戦時のナチスドイツでは敵国の経済へ損害を与えるべく無制限潜水艦作戦と呼ばれる潜水艦による作戦が行われていました。<br>
本ゲームの目的は、第二次大戦中のドイツ潜水艦U-Boatの艦長として潜水艦を指揮し魚雷攻撃によって敵船団を撃沈することです。</p>
                  <h5 glot-model='RES_Difficulty'>難易度</h5>
                  <p glot-model='RES_DifficultyOverview'>難易度によって敵船の数、クリアに必要な撃沈トン数が変わります。</p>
                  <table>
                    <thead>
                    <tr><th glot-model='RES_Difficulty'>難易度</th><th glot-model='RES_EnemyCount'>駆逐艦の数</th><th glot-model='RES_MerchantCount'>商船の数</th><th glot-model='RES_SunkTonnage'>撃沈トン数</th><tr>
                    </thead>
                  <tbody>
                    <tr>
                      <td glot-model='RES_Easy'>簡単</td><td>1</td><td>5</td><td>8000</td>
                    </tr>
                    <tr>
                      <td glot-model='RES_Normal'>普通</td><td>2</td><td>4</td><td>12000</td>
                    </tr>
                    <tr>
                      <td glot-model='RES_Difficult'>難しい</td><td>4</td><td>3</td><td>20000</td>
                    </tr>
                </tbody>
              </table>
            <h5 glot-model='RES_OperationExplanation'>操作説明</h5>
            <h6 glot-model='RES_SubmarineMove'>潜水艦の移動</h6>
            <p glot-model='RES_Manual1'>
潜水艦を移動させるには左下のコントロールパネルから行います。
コントロールパネルには"エンジンテレグラフ", "方位指示盤", "深度指示盤"があり、それぞれ操作することで潜水艦のエンジン出力、進行方向、深度を変更することができます。
            </p>
            <h6 glot-model='RES_ManualDetail2'>見張り、聴音</h6>
            <p glot-model='RES_ManualDetail3'>
              右下の指示パネルから、周りの状況を確認することが出来ます。<br>
                各ボタンをタップすることで左上のメッセージパネルに確認した敵船の情報が表示されます。<br>
                左側の見張りボタンで目視での見張り、中央の聴音ボタンでハイドロフォンの聴音を行うことができます。<br>
目視での見張りは潜水艦が浮上しているとき、ハイドロフォンでの聴音は潜水艦が潜航しているときにのみ利用できます。
            </p>
            <h6 glot-model='RES_ManualDetail4'>潜望鏡画面</h6>
            <p glot-model='RES_ManualDetail5'>
              右下の指示パネル右側の潜望鏡ボタンをタップすることで潜望鏡画面を表示することができます。<br>
潜望鏡画面では潜望鏡による敵船の確認、魚雷の諸元入力、魚雷の発射を行います。
            </p>
            <h6 glot-model='RES_ManualDetail6'>倍速表示</h6>
            <p glot-model='RES_ManualDetail7'>
              右上のステータスパネル内の時間倍率ボタンでゲーム内時間の進行速度を変更することができます。<br>
時間倍率は1~16倍まで変更することができます。
            </p>
            <h5 glot-model='RES_ManualDetail8'>敵船の行動</h5>
            <p glot-model='RES_ManualDetail9'>
              敵の船団は通常は目的地に向かって一定速度で一定方向へ進み続けます。<br>
                しかし、一度潜水艦を発見すると対潜航行に入り商船は魚雷を回避するように進み、駆逐艦は潜水艦に向かって攻撃を開始してきます。<br>
駆逐艦の攻撃方法は2種類あり、潜水艦が浮上している場合は砲撃による攻撃、潜航中は爆雷攻撃を行います。
            </p>
            <h5 glot-model='RES_ManualDetail10'>バッテリー、酸素残量</h5>
            <p glot-model='RES_ManualDetail11'>
              潜水艦はバッテリーでスクリューを回すため徐々にバッテリー残量が減っていきます。<br>
                バッテリーがなくなると前進、後退が行えなくなりますが、潜航、浮上は可能です。<br>
                潜航中は潜水艦内の酸素を消費するため徐々に酸素残量が減っていきいます。<br>
酸素残量が0になるとゲームオーバーとなってしまうので浮上し回復してください。
            </p>
            <h5 glot-model='RES_ManualDetail12'>セーブ機能</h5>
            <p glot-model='RES_ManualDetail13'>
              ゲーム中に右上の終了ボタンをタップすることによって状態を保存し、タイトル画面のコンティニューボタンからゲームを再開することができます。<br>
また、ゲーム内時間での1分ごとに自動で状態の保存が行われます。
            </p>
                </div>
                <div class="buttonContainer">
                    <button type="button" id="manualBackButton" class=" btn btn-info btn-sm" glot-model='RES_back'>戻る</button>
                </div>
            </div>
            <!-- 難易度選択画面 -->
            <div id="diffSelectPage" class="absolutePage vignette hiddenPage">
                <div class="menu text-center">
                    <div>
                        <div class="titleBackground">
                            <h1 glot-model='RES_Title'>潜水艦3Dシミュレーター</h1>
                        </div>
                        <div class="menuButtonWrapper">
                            <p>
                                <input type="radio" class="btn-check" name="diffSelect" id="diffEasy"
                                    autocomplete="off">
                                <label class="btn btn-info btn-sm" for="diffEasy" glot-model='RES_Easy'>簡単</label>
                            </p>
                            <p>
                                <input type="radio" class="btn-check" name="diffSelect" id="diffNormal"
                                    autocomplete="off">
                                <label class="btn btn-info btn-sm" for="diffNormal" glot-model='RES_Normal'>普通</label>
                            </p>
                            <p>
                                <input type="radio" class="btn-check" name="diffSelect" id="diffHard"
                                    autocomplete="off">
                                <label class="btn btn-info btn-sm" for="diffHard" glot-model='RES_Difficult'>難しい</label>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="buttonContainer">
                    <button type="button" id="diffSelectBackbutton" class=" btn btn-info btn-sm" glot-model='RES_Back'>戻る</button>
                    <button type="button" id="startButton" class=" btn btn-info btn-sm" glot-model='RES_Start' disabled>スタート</button>
                </div>
            </div>
            <!-- ロード画面 -->
            <div id="loadPage" class="absolutePage vignette hiddenPage">
                <div class="progress menu">
                    <div id="loadProgressBar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 3d page -->
    <div id="threePage" class="hiddenPage">
        <!-- 拡大ボタン -->
        <div id="zoomButtonArea">
            <button id="zoomButton" class=" btn btn-info">1.6x</button>
        </div>
        <!-- 3D画面 -->
        <div id="canvasContainer">
            <canvas id="threePageCanvas"></canvas>
            <!-- コンパス -->
            <div id="verticalLine" class="aimLine"></div>
            <div id="horizontalLine" class="aimLine"></div>
        </div>
        <div id="inputBoad" class="container">
            <div class="row">
                <div id="bearingContainer" class="col-4 inputPartsContainer">
                    <img id="bearingBack" class="inputPanel" src="resources/bearingBack.png">
                    <img id="bearingAllow" class="inputFront" src="resources/bearingAllow.png">
                    <img class="inputPlate" src="resources/bearingPlate.png">
                </div>
                <div id="speedContainer" class="col-4 inputPartsContainer">
                    <img id="speedBack" class="inputPanel" src="resources/speedBack.png">
                    <img id="speedAllow" class="inputFront" src="resources/speedAllow.png">
                    <img class="inputPlate" src="resources/speedPlate.png">
                </div>
                <div id="gyroContainer" class="col-4 inputPartsContainer">
                    <img id="gyroBack" class="inputPanel" src="resources/gyroBack.png">
                    <img id="gyroAllow" class="inputFront" src="resources/gyroAllow.png">
                    <img class="inputPlate" src="resources/gyroPlate.png">
                </div>
            </div>
            <div class="row">
                <div id="rangeContainer" class="col-4 inputPartsContainer">
                    <img id="rangeBack" class="inputPanel" src="resources/rangeBack.png">
                    <img id="rangeAllow" class="inputFront" src="resources/rangeAllow.png">
                    <img class="inputPlate" src="resources/rangePlate.png">
                </div>
                <div id="aOnBowContainer" class="col-4 inputPartsContainer">
                    <img id="aOnBowBack" class="inputPanel" src="resources/aOnBowBack.png">
                    <img id="aOnBowAllow" class="inputFront" src="resources/aOnBowAllow.png">
                    <img class="inputPlate" src="resources/aOnBowPlate.png">
                </div>
                <div id="fireContainer" class="col-4 inputPartsContainer">
                    <img id="fireButton" class="inputPanel fireButton" src="resources/fireOff.png">
                    <img class="inputPlate" class="fireButton" src="resources/firePlate.png">
                </div>
            </div>
            <div class="row">
                <div id="periscopeStatusContainer" class="col-8">
                    <div class="row">
                        <div class="col-6" glot-model='RES_ArrivalTime'>
                            到達時間
                        </div>
                        <div class="col-6">
                          <span id="hitTime">000</span><span glot-model='RES_Seconds' style='margin-left: 10px'>秒</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6" glot-model='RES_RemaningTorpedo'>
                            魚雷残数
                        </div>
                        <div class="col-6">
                            <p><span id="torpedoCountPeriscope" class="torpedoCount"></span> / 14</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6" glot-model='RES_NowTime'>
                            現在時刻
                        </div>
                        <div class="col-6 time">
                            <p>00:00:00</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Area -->
    <div id="messageArea2" class="absolutePanel hiddenPage">
        <div id="messageBox2" class="overflow-auto ms-3 mt-1"></div>
        <img id="messageAreaCloseButton" class="panelCloseButton" src="resources/close_up.png" isClose="false">
    </div>

    <!-- Controll Area -->
    <div id="controllArea2" class="absolutePanel hiddenPage">
        <div class="row">
            <div id="telegraphArea" class="col-4">
                <img id="engineTelegraph" src="resources/telegraphBack.png">
                <img id="telegraphAllow" class="frontImage" src="resources/telegraphAllow.png">
                <img id="telegraphAllowShadow" class="frontImage shadowAllow" src="resources/telegraphAllow.png">
                <p><span id="dispSpeed">000</span><span>kt</span></p>
            </div>
            <div id="compassArea" class="col-4">
                <img id="compassBack" src="resources/compassBack.png">
                <img id="compassFrame" src="resources/compassFrame.png">
                <img id="compassFront" src="resources/compassCenter.png">
                <img id="compassAllowShadow" src="resources/compassAllowShadow.png">
                <p><span id="dispCourse">000</span><span>°</span></p>
            </div>
            <div id="depthMeterArea" class="col-4">
                <button type="button" class="btn btn-info" id="periscopeDepthButton"><img
                        src="./resources/periscope_256x256.png" /></button>
                <img id="depthMater" src="resources/depthMater.png">
                <img id="depthMaterAllow" class="frontImage" src="resources/depthAllow.png">
                <img id="depthMaterAllowShadow" class="frontImage shadowAllow" noupdate="false"
                    src="resources/depthAllow.png">
                <p><span id="dispDepth">000</span><span>m</span></p>
            </div>
        </div>
        <img id="controllAreaCloseButton" class="panelCloseButton" src="resources/close_down.png" isClose="false">
    </div>

    <!-- Status Area -->
    <div id="statusArea2" class="absolutePanel hiddenPage">
        <div class="row">
            <div class="col-5">
                <p glot-model='RES_Damage'>ダメージ</p>
            </div>
            <div class="col" id="damage">
                <div class="progress" id="damageBar">
                    <div class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-5">
                <p glot-model='RES_Battery'>バッテリー</p>
            </div>
            <div class="col" id="battery">
                <div class="progress">
                    <div class="progress-bar bg-warning" role="progressbar" style="width: 0%"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-5">
                <p glot-model='RES_RemaningO2'>酸素残量</p>
            </div>
            <div class="col" id="o2">
                <div class="progress">
                    <div class="progress-bar bg-info" role="progressbar" style="width: 0%"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-5">
                <p glot-model='RES_RemaningTorpedo'>魚雷残数</p>
            </div>
            <div class="col" id="torpedo">
                <p><span id="torpedoCountMain" class="torpedoCount"></span> / 14</p>
            </div>
        </div>
        <div class="row">
            <div class="col-5">
                <p glot-model='RES_NowTime'>現在時刻</p>
            </div>
            <div class="col time">
                <p>00:00:00</p>
            </div>
        </div>
        <div id="timeSpeedRow" class="row mt-2">
            <div id="timeSpeedLabel" class="col-4">
                <p glot-model='RES_TimeMag'>時間倍率</p>
            </div>
            <div id="timeSpeedVal" class="col" id="timeSpeed">
                <p>
                    <button id="speedMinButton" class="btn btn-warning speedChangeButton">&lt;&lt;</button>
                    <button id="speedReduceButton" class="btn btn-warning speedChangeButton">&lt;</button>
                    <span id="dispTimeSpeed">0001</span>
                    <span glot-model='RES_Times'>倍</span>
                    <button id="speedIncreaseButton" class="btn btn-warning speedChangeButton">&gt;</button>
                    <button id="speedMaxButton" class="btn btn-warning speedChangeButton">&gt;&gt;</button>
                </p>
            </div>
        </div>
        <img id="statusAreaCloseButton" class="panelCloseButton" src="resources/close_up.png" isClose="false">
        <img id="exitButton" src="resources/exit.png">
    </div>

    <!-- instruction Area -->
    <div id="instructionArea" class="absolutePanel hiddenPage">
        <div class="row">
            <div class="col">
                <button type="button" class="btn btn-danger" id="observeButton"><img
                        src="./resources/binoculars_256x256.png" width="25" height="25" /></button>
            </div>
            <div class="col">
                <button type="button" class="btn btn-success" id="hydrophoneButton" disabled><img
                        src="./resources/hydrophone_256x256.png" width="25" height="25" /></button>
            </div>
            <div class="col">
                <button type="button" class="btn btn-info" id="periscopeButton"><img
                        src="./resources/target.png" width="25" height="25" /></button>
            </div>
        </div>
    </div>

    <!-- GameOver Dialog -->
    <div class="modal fade" id="gameOverDialog" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="gameOverDialogLabel" aria-hidden="true">
        <div id="gameOverMenu" class="modal-dialog position-absolute">
            <div class="modal-content">
                <h1 id="gameOverMessage" glot-model='RES_Sinking'>撃沈…</h1>
                <button class="backTitleButton btn btn-info" type="button" class=""
                    data-bs-dismiss="modal">タイトル画面に戻る</button>
            </div>
        </div>
    </div>

    <!-- GameClear Dialog -->
    <div class="modal fade" id="gameClearDialog" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="gameClearDialogLabel" aria-hidden="true">
        <div id="gameClearMenu" class="modal-dialog position-absolute">
            <div class="modal-content">
                <h1 id="gameClearMessage" glot-model='RES_Clear'>ゲームクリア</h1>
                <button class="backTitleButton btn btn-info" type="button" class="btn btn-info"
                    data-bs-dismiss="modal" glot-model='RES_BackToTitle'>タイトル画面に戻る</button>
            </div>
        </div>
    </div>

    <!-- メッセージ翻訳用 -->
    <div style="display: none">
      <span id='RES_Hydrophone' glot-model='RES_Hydrophone'>聴音員</span>
      <span id='RES_HydrophoneDiscover' glot-model='RES_HydrophoneDiscover'>船音をxxx隻確認！</span>
      <span id='RES_EnemyShip' glot-model='RES_EnemyShip'>敵船</span>
      <span id='RES_NoSounds' glot-model='RES_NoSounds'>船音無し！</span>
      <span id='RES_LowSounds' glot-model='RES_LowSounds'>音量微小</span>
      <span id='RES_MiddleSounds' glot-model='RES_LowSounds'>音量中</span>
      <span id='RES_SomewhatLargeSounds' glot-model='RES_MiddleSounds'>音量やや大きい</span>
      <span id='RES_LargeSounds' glot-model='RES_SomewhatLargeSounds'>音量大</span>
      <span id='RES_Direction' glot-model='RES_Direction'>方位</span>
      <span id='RES_Observer' glot-model='RES_Observer'>監視員</span>
      <span id='RES_ObserverDiscover' glot-model='RES_ObserverDiscover'>船影をxxx隻確認！</span>
      <span id='RES_Range' glot-model='RES_Range'>距離</span>
      <span id='RES_Course' glot-model='RES_Course'>針路</span>
      <span id='RES_NoShips' glot-model='RES_NoShips'>船影無し！</span>
      <span id='RES_ShipSpeed' glot-model='RES_ShipSpeed'>船速</span>
      <span id='RES_AheadFull' glot-model='RES_AheadFull'>全速前進</span>
      <span id='RES_AheadHalf' glot-model='RES_AheadHalf'>半速前進</span>
      <span id='RES_AheadSlow' glot-model='RES_AheadSlow'>微速前進</span>
      <span id='RES_AllStop' glot-model='RES_AllStop'>機関停止</span>
      <span id='RES_AsternSlow' glot-model='RES_AsternSlow'>微速後進</span>
      <span id='RES_AsternHalf' glot-model='RES_AsternHalf'>半速後進</span>
      <span id='RES_AsternFull' glot-model='RES_AsternFull'>全速後進</span>
      <span id='RES_ChiefEngineer' glot-model='RES_ChiefEngineer'>機関長</span>
      <span id='RES_Navigator' glot-model='RES_Navigator'>航海長</span>
      <span id='RES_ChangeCourse' glot-model='RES_ChangeCourse'>針路をxxxに変更</span>
      <span id='RES_ChangeDepth' glot-model='RES_ChangeDepth'>深度をxxxに変更</span>
    </div>

    <!-- scripts -->
    <!-- <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script> -->
    <script type="importmap">
        {
            "imports": {
                "three": "./javascript/lib/three.module.js"
            }
        }
    </script>
    <script src="./javascript/lib/jquery-3.6.0.min.js" type="module"></script>
    <script src="./javascript/lib/bootstrap.min.js" type="module"></script>
    <script src="./javascript/lib/glottologist.min.js"></script>
    <script src="./javascript/lib/stats.min.js"></script>
    <script src="./javascript/main.js" type="module"></script>
</body>
</html>
